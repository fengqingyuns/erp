<?xml version="1.0" encoding="UTF-8" ?>
<!--suppress ALL -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hanyun.scm.api.dao.StockPickingDao">
    <resultMap id="BaseResultMap" type="com.hanyun.scm.api.domain.StockPicking">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="stock_picking_id" property="stockPickingId" jdbcType="VARCHAR"/>
        <result column="stock_picking_document_id" property="stockPickingDocumentId" jdbcType="VARCHAR"/>
        <result column="brand_id" property="brandId" jdbcType="VARCHAR"/>
        <result column="store_id" property="storeId" jdbcType="VARCHAR"/>
        <result column="store_name" property="storeName" jdbcType="VARCHAR"/>
        <result column="src_order_id" property="srcOrderId" jdbcType="VARCHAR"/>
        <result column="src_order_document_id" property="srcOrderDocumentId" jdbcType="VARCHAR"/>
        <result column="supplier_id" property="supplierId" jdbcType="VARCHAR"/>
        <result column="supplier_name" property="supplierName" jdbcType="VARCHAR"/>
        <result column="to_warehouse_id" property="toWarehouseId" jdbcType="VARCHAR"/>
        <result column="to_warehouse_name" property="toWarehouseName" jdbcType="VARCHAR"/>
        <result column="src_warehouse_id" property="srcWarehouseId" jdbcType="VARCHAR"/>
        <result column="src_warehouse_name" property="srcWarehouseName" jdbcType="VARCHAR"/>
        <result column="purchase_price" property="purchasePrice" jdbcType="BIGINT"/>
        <result column="stock_picking_price" property="stockPickingPrice" jdbcType="BIGINT"/>
        <result column="stock_picking_status" property="stockPickingStatus" jdbcType="TINYINT"/>
        <result column="purchase_amount" property="purchaseAmount" jdbcType="BIGINT"/>
        <result column="picking_amount" property="pickingAmount" jdbcType="BIGINT"/>
        <result column="operator_id" property="operatorId" jdbcType="VARCHAR"/>
        <result column="operator_name" property="operatorName" jdbcType="VARCHAR"/>
        <result column="odoo_picking_income_id" property="odooPickingIncomeId" jdbcType="INTEGER"/>
        <result column="odoo_picking_out_id" property="odooPickingOutId" jdbcType="INTEGER"/>
        <result column="stock_picking_type" property="stockPickingType" jdbcType="TINYINT"/>
        <result column="stock" property="stock" jdbcType="BIGINT"/>
        <result column="income_reason" property="incomeReason" jdbcType="TINYINT"/>
        <result column="out_reason" property="outReason" jdbcType="TINYINT"/>
        <result column="remark" property="remark" jdbcType="VARCHAR"/>
        <result column="create_time" property="createTime" jdbcType="TIMESTAMP"/>
        <result column="update_time" property="updateTime" jdbcType="TIMESTAMP"/>
        <result column="valid_status" property="validStatus" jdbcType="TINYINT"/>
        <result column="to_store_name" property="toStoreName" jdbcType="VARCHAR"/>
        <result column="to_store_id" property="toStoreId" jdbcType="VARCHAR"/>
        <result column="auditor_id" property="auditorId" jdbcType="VARCHAR"/>
        <result column="auditor_name" property="auditorName" jdbcType="VARCHAR"/>
        <result column="audit_time" property="auditorTime" jdbcType="TIMESTAMP"/>
        <result column="business_man_id" property="businessManId" jdbcType="VARCHAR"/>
        <result column="business_man_name" property="businessManName" jdbcType="VARCHAR"/>
        <result column="purchase_return_reason" property="purchaseReturnReason" jdbcType="TINYINT"/>
        <result column="distinct_price" property="distinctPrice" jdbcType="BIGINT"/>
        <result column="purchase_return_time" property="purchaseReturnTime" jdbcType="TIMESTAMP"/>
        <result column="purchase_type" property="purchaseType" jdbcType="TINYINT"/>
        <result column="payment_price" property="paymentPrice" jdbcType="INTEGER"/>
        <result column="payment_status" property="paymentStatus" jdbcType="TINYINT"/>
        <result column="purchase_return_status" property="purchaseReturnStatus" jdbcType="TINYINT"/>
        <result column="finish_purchase_return_amount" property="finishPurchaseReturnAmount" jdbcType="BIGINT"/>
    </resultMap>
    <sql id="Base_Column_List"> 
        id, stock_picking_id, brand_id, store_id, src_order_id, supplier_id, supplier_name, to_warehouse_id, to_warehouse_name, src_warehouse_id,
        src_warehouse_name, purchase_price, stock_picking_price, stock_picking_status, purchase_amount, picking_amount, operator_id, operator_name,
        odoo_picking_income_id, odoo_picking_out_id, stock_picking_type, stock, income_reason, out_reason, remark, create_time, update_time,valid_status,
        store_name,stock_picking_document_id,src_order_document_id,to_store_name,to_store_id,auditor_id,auditor_name,audit_time,business_man_id,
        business_man_name, purchase_return_reason, distinct_price, purchase_return_time, purchase_type, payment_price, payment_status,purchase_return_status,
        finish_purchase_return_amount
    </sql>
    <select id="selectByStockPickingId" resultMap="BaseResultMap" parameterType="java.lang.String">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        WHERE stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
    </select>
    <select id="countReceiptAll" parameterType="com.hanyun.scm.api.domain.StockPicking"
            resultType="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM stock_picking
        <where>
            valid_status = 0
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name = #{supplierName,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseId != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="purchasePrice != null">
                AND purchase_price = #{purchasePrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingPrice != null">
                AND stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="purchaseAmount != null">
                AND purchase_amount = #{purchaseAmount,jdbcType=BIGINT}
            </if>
            <if test="pickingAmount != null">
                AND picking_amount = #{pickingAmount,jdbcType=BIGINT}
            </if>
            <if test="operatorId != null">
                AND operator_id = #{operatorId,jdbcType=VARCHAR}
            </if>
            <if test="operatorName != null">
                AND operator_name = #{operatorName,jdbcType=VARCHAR}
            </if>
            <if test="odooPickingIncomeId != null">
                AND odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER}
            </if>
            <if test="odooPickingOutId != null">
                AND odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stock != null">
                AND stock = #{stock,jdbcType=BIGINT}
            </if>
            <if test="incomeReason != null">
                AND income_reason = #{incomeReason,jdbcType=TINYINT}
            </if>
            <if test="outReason != null">
                AND out_reason = #{outReason,jdbcType=TINYINT}
            </if>
            <if test="remark != null">
                AND remark = #{remark,jdbcType=VARCHAR}
            </if>
            <if test="createTime != null">
                AND create_time = #{createTime,jdbcType=TIMESTAMP}
            </if>
            <if test="updateTime != null">
                AND update_time = #{updateTime,jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
        </where>
    </select>
    <select id="countAll" parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest"
            resultType="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM stock_picking
        <where>
            valid_status = 0
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name LIKE concat('%',#{supplierName,jdbcType=VARCHAR}, '%')
            </if>
            <if test="toWarehouseId != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="purchasePrice != null">
                AND purchase_price = #{purchasePrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingPrice != null">
                AND stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="purchaseAmount != null">
                AND purchase_amount = #{purchaseAmount,jdbcType=BIGINT}
            </if>
            <if test="pickingAmount != null">
                AND picking_amount = #{pickingAmount,jdbcType=BIGINT}
            </if>
            <if test="operatorId != null">
                AND operator_id = #{operatorId,jdbcType=VARCHAR}
            </if>
            <if test="operatorName != null">
                AND operator_name LIKE concat('%', #{operatorName,jdbcType=VARCHAR}, '%')
            </if>
            <if test="odooPickingIncomeId != null">
                AND odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER}
            </if>
            <if test="odooPickingOutId != null">
                AND odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stock != null">
                AND stock = #{stock,jdbcType=BIGINT}
            </if>
            <if test="incomeReason != null">
                AND income_reason = #{incomeReason,jdbcType=TINYINT}
            </if>
            <if test="outReason != null">
                AND out_reason = #{outReason,jdbcType=TINYINT}
            </if>
            <if test="remark != null">
                AND remark = #{remark,jdbcType=VARCHAR}
            </if>
            <if test="queryBeginTime != null">
                AND create_time <![CDATA[>=]]> #{queryBeginTime,jdbcType=TIMESTAMP}
            </if>
            <if test="queryEndTime != null">
                AND create_time <![CDATA[<=]]> #{queryEndTime,jdbcType=TIMESTAMP}
            </if>
            <if test="beginTime != null">
                AND create_time <![CDATA[>=]]> #{beginTime,jdbcType=TIMESTAMP}
            </if>
            <if test="endTime != null">
                AND create_time <![CDATA[<=]]> #{endTime,jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreId != null">
                AND to_store_id = #{toStoreId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreName != null">
                AND to_store_name = #{toStoreName,jdbcType=VARCHAR}
            </if>
            <if test="purchaseType != null">
                AND purchase_type = #{purchaseType, jdbcType=TINYINT}
            </if>
            <if test="businessManId != null">
                AND business_man_id = #{businessManId, jdbcType=VARCHAR}
            </if>
            <if test="businessManName != null">
                AND business_man_name LIKE concat('%',#{businessManName, jdbcType=VARCHAR}, '%')
            </if>
            <if test="purchaseReturnStatus != null">
                AND purchase_return_status = #{purchaseReturnStatus, jdbcType=TINYINT}
            </if>
        </where>
    </select>
    <select id="queryReceipt" resultMap="BaseResultMap" parameterType="com.hanyun.scm.api.domain.StockPicking">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
            valid_status = 0
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name = #{supplierName,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseId != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="purchasePrice != null">
                AND purchase_price = #{purchasePrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingPrice != null">
                AND stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="purchaseAmount != null">
                AND purchase_amount = #{purchaseAmount,jdbcType=BIGINT}
            </if>
            <if test="pickingAmount != null">
                AND picking_amount = #{pickingAmount,jdbcType=BIGINT}
            </if>
            <if test="operatorId != null">
                AND operator_id = #{operatorId,jdbcType=VARCHAR}
            </if>
            <if test="operatorName != null">
                AND operator_name = #{operatorName,jdbcType=VARCHAR}
            </if>
            <if test="odooPickingIncomeId != null">
                AND odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER}
            </if>
            <if test="odooPickingOutId != null">
                AND odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stock != null">
                AND stock = #{stock,jdbcType=BIGINT}
            </if>
            <if test="incomeReason != null">
                AND income_reason = #{incomeReason,jdbcType=TINYINT}
            </if>
            <if test="outReason != null">
                AND out_reason = #{outReason,jdbcType=TINYINT}
            </if>
            <if test="remark != null">
                AND remark = #{remark,jdbcType=VARCHAR}
            </if>
            <if test="createTime != null">
                AND create_time = #{createTime,jdbcType=TIMESTAMP}
            </if>
            <if test="updateTime != null">
                AND update_time = #{updateTime,jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="beginTime != null and beginTime != ''">
                AND create_time <![CDATA[>=]]> #{beginTime, jdbcType=TIMESTAMP}
            </if>
            <if test="endTime != null and endTime !=''">
                AND create_time <![CDATA[<=]]> #{endTime, jdbcType=TIMESTAMP}
            </if>
        </where>
        ORDER BY id DESC
        <if test="pageSize != null and pageSize > 0">
            LIMIT #{recordNo,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
        </if>
    </select>
    <select id="select" resultMap="BaseResultMap"
            parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
            valid_status = 0
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name LIKE concat('%',#{supplierName,jdbcType=VARCHAR}, '%')
            </if>
            <if test="toWarehouseId != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="purchasePrice != null">
                AND purchase_price = #{purchasePrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingPrice != null">
                AND stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="purchaseAmount != null">
                AND purchase_amount = #{purchaseAmount,jdbcType=BIGINT}
            </if>
            <if test="pickingAmount != null">
                AND picking_amount = #{pickingAmount,jdbcType=BIGINT}
            </if>
            <if test="operatorId != null">
                AND operator_id = #{operatorId,jdbcType=VARCHAR}
            </if>
            <if test="operatorName != null">
                AND operator_name LIKE concat('%', #{operatorName,jdbcType=VARCHAR}, '%')
            </if>
            <if test="odooPickingIncomeId != null">
                AND odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER}
            </if>
            <if test="odooPickingOutId != null">
                AND odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stock != null">
                AND stock = #{stock,jdbcType=BIGINT}
            </if>
            <if test="incomeReason != null">
                AND income_reason = #{incomeReason,jdbcType=TINYINT}
            </if>
            <if test="outReason != null">
                AND out_reason = #{outReason,jdbcType=TINYINT}
            </if>
            <if test="remark != null">
                AND remark = #{remark,jdbcType=VARCHAR}
            </if>
            <if test="queryBeginTime != null">
                AND create_time <![CDATA[>=]]> #{queryBeginTime,jdbcType=TIMESTAMP}
            </if>
            <if test="queryEndTime != null">
                AND create_time <![CDATA[<=]]> #{queryEndTime,jdbcType=TIMESTAMP}
            </if>
            <if test="beginTime != null">
                AND create_time <![CDATA[>=]]> #{beginTime,jdbcType=TIMESTAMP}
            </if>
            <if test="endTime != null">
                AND create_time <![CDATA[<=]]> #{endTime,jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreId != null">
                AND to_store_id = #{toStoreId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreName != null">
                AND to_store_name = #{toStoreName,jdbcType=VARCHAR}
            </if>
            <if test="purchaseType != null">
                AND purchase_type = #{purchaseType, jdbcType=TINYINT}
            </if>
            <if test="businessManId != null">
                AND business_man_id = #{businessManId, jdbcType=VARCHAR}
            </if>
            <if test="businessManName != null">
                AND business_man_name LIKE concat('%',#{businessManName, jdbcType=VARCHAR}, '%')
            </if>
            <if test="purchaseReturnStatus != null">
                AND purchase_return_status = #{purchaseReturnStatus, jdbcType=TINYINT}
            </if>
        </where>
        ORDER BY id DESC
        <if test="pageSize != null and pageSize > 0">
            LIMIT #{recordNo,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
        </if>
    </select>
    <delete id="deleteByStockPickingId" parameterType="java.lang.String">
        DELETE FROM stock_picking
        WHERE stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
    </delete>
    <insert id="insertSelective" parameterType="com.hanyun.scm.api.domain.StockPicking">
        INSERT INTO stock_picking
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="stockPickingId != null">
                stock_picking_id,
            </if>
            <if test="stockPickingDocumentId != null">
                stock_picking_document_id,
            </if>
            <if test="brandId != null">
                brand_id,
            </if>
            <if test="storeId != null">
                store_id,
            </if>
            <if test="srcOrderId != null">
                src_order_id,
            </if>
            <if test="srcOrderDocumentId != null">
                src_order_document_id,
            </if>
            <if test="supplierId != null">
                supplier_id,
            </if>
            <if test="supplierName != null">
                supplier_name,
            </if>
            <if test="toWarehouseId != null">
                to_warehouse_id,
            </if>
            <if test="toWarehouseName != null">
                to_warehouse_name,
            </if>
            <if test="srcWarehouseId != null">
                src_warehouse_id,
            </if>
            <if test="srcWarehouseName != null">
                src_warehouse_name,
            </if>
            <if test="purchasePrice != null">
                purchase_price,
            </if>
            <if test="stockPickingPrice != null">
                stock_picking_price,
            </if>
            <if test="stockPickingStatus != null">
                stock_picking_status,
            </if>
            <if test="purchaseAmount != null">
                purchase_amount,
            </if>
            <if test="pickingAmount != null">
                picking_amount,
            </if>
            <if test="operatorId != null">
                operator_id,
            </if>
            <if test="operatorName != null">
                operator_name,
            </if>
            <if test="odooPickingIncomeId != null">
                odoo_picking_income_id,
            </if>
            <if test="odooPickingOutId != null">
                odoo_picking_out_id,
            </if>
            <if test="stockPickingType != null">
                stock_picking_type,
            </if>
            <if test="stock != null">
                stock,
            </if>
            <if test="incomeReason != null">
                income_reason,
            </if>
            <if test="outReason != null">
                out_reason,
            </if>
            <if test="remark != null">
                remark,
            </if>
            <if test="validStatus!= null">
                valid_status ,
            </if>
            <if test="toStoreId != null">
                to_store_id ,
            </if>
            <if test="toStoreName != null">
                to_store_name,
            </if>
            <if test="auditorId != null">
                auditor_id,
            </if>
            <if test="auditorName != null">
                auditor_name,
            </if>
            <if test="auditorTime != null">
                audit_time,
            </if>
            <if test="businessManId != null">
                business_man_id,
            </if>
            <if test="businessManName != null">
                business_man_name,
            </if>
            <if test="purchaseReturnReason != null">
                purchase_return_reason,
            </if>
            <if test="distinctPrice != null">
                distinct_price,
            </if>
            <if test="purchaseReturnTime != null">
                purchase_return_time,
            </if>
            <if test="purchaseType != null">
                purchase_type,
            </if>
            purchase_return_status,
            finish_purchase_return_amount,
            payment_price,
            payment_status,
            create_time,
            update_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="stockPickingId != null">
                #{stockPickingId,jdbcType=VARCHAR},
            </if>
            <if test="stockPickingDocumentId != null">
                #{stockPickingDocumentId,jdbcType=VARCHAR},
            </if>
            <if test="brandId != null">
                #{brandId,jdbcType=VARCHAR},
            </if>
            <if test="storeId != null">
                #{storeId,jdbcType=VARCHAR},
            </if>
            <if test="srcOrderId != null">
                #{srcOrderId,jdbcType=VARCHAR},
            </if>
            <if test="srcOrderDocumentId != null">
                #{srcOrderDocumentId,jdbcType=VARCHAR},
            </if>
            <if test="supplierId != null">
                #{supplierId,jdbcType=VARCHAR},
            </if>
            <if test="supplierName != null">
                #{supplierName,jdbcType=VARCHAR},
            </if>
            <if test="toWarehouseId != null">
                #{toWarehouseId,jdbcType=VARCHAR},
            </if>
            <if test="toWarehouseName != null">
                #{toWarehouseName,jdbcType=VARCHAR},
            </if>
            <if test="srcWarehouseId != null">
                #{srcWarehouseId,jdbcType=VARCHAR},
            </if>
            <if test="srcWarehouseName != null">
                #{srcWarehouseName,jdbcType=VARCHAR},
            </if>
            <if test="purchasePrice != null">
                #{purchasePrice,jdbcType=BIGINT},
            </if>
            <if test="stockPickingPrice != null">
                #{stockPickingPrice,jdbcType=BIGINT},
            </if>
            <if test="stockPickingStatus != null">
                #{stockPickingStatus,jdbcType=TINYINT},
            </if>
            <if test="purchaseAmount != null">
                #{purchaseAmount,jdbcType=BIGINT},
            </if>
            <if test="pickingAmount != null">
                #{pickingAmount,jdbcType=BIGINT},
            </if>
            <if test="operatorId != null">
                #{operatorId,jdbcType=VARCHAR},
            </if>
            <if test="operatorName != null">
                #{operatorName,jdbcType=VARCHAR},
            </if>
            <if test="odooPickingIncomeId != null">
                #{odooPickingIncomeId,jdbcType=INTEGER},
            </if>
            <if test="odooPickingOutId != null">
                #{odooPickingOutId,jdbcType=INTEGER},
            </if>
            <if test="stockPickingType != null">
                #{stockPickingType,jdbcType=TINYINT},
            </if>
            <if test="stock != null">
                #{stock,jdbcType=BIGINT},
            </if>
            <if test="incomeReason != null">
                #{incomeReason,jdbcType=TINYINT},
            </if>
            <if test="outReason != null">
                #{outReason,jdbcType=TINYINT},
            </if>
            <if test="remark != null">
                #{remark,jdbcType=VARCHAR},
            </if>
            <if test="validStatus!= null">
                #{validStatus,jdbcType=TINYINT},
            </if>
            <if test="toStoreId != null">
                #{toStoreId,jdbcType=VARCHAR},
            </if>
            <if test="toStoreName != null">
                #{toStoreName,jdbcType=VARCHAR},
            </if>
            <if test="auditorId != null">
                #{auditorId,jdbcType=VARCHAR},
            </if>
            <if test="auditorName != null">
                #{auditorName,jdbcType=VARCHAR},
            </if>
            <if test="auditorTime != null">
                #{auditorTime,jdbcType=TIMESTAMP},
            </if>
            <if test="businessManId != null">
                #{businessManId,jdbcType=VARCHAR},
            </if>
            <if test="businessManName != null">
                #{businessManName,jdbcType=VARCHAR},
            </if>
            <if test="purchaseReturnReason != null">
                #{purchaseReturnReason, jdbcType=TINYINT},
            </if>
            <if test="distinctPrice != null">
                #{distinctPrice, jdbcType=BIGINT},
            </if>
            <if test="purchaseReturnTime != null">
                #{purchaseReturnTime, jdbcType=TIMESTAMP},
            </if>
            <if test="purchaseType != null">
                #{purchaseType, jdbcType=TINYINT},
            </if>
            1,
            0,
            0,
            0,
            NOW(),
            NOW()
        </trim>
    </insert>
    <update id="updateByStockPickingId" parameterType="com.hanyun.scm.api.domain.StockPicking">
        UPDATE stock_picking
        <set>
            <if test="brandId != null">
                brand_id = #{brandId,jdbcType=VARCHAR},
            </if>
            <if test="storeId != null">
                store_id = #{storeId,jdbcType=VARCHAR},
            </if>
            <if test="srcOrderId != null">
                src_order_id = #{srcOrderId,jdbcType=VARCHAR},
            </if>
            <if test="supplierId != null">
                supplier_id = #{supplierId,jdbcType=VARCHAR},
            </if>
            <if test="supplierName != null">
                supplier_name = #{supplierName,jdbcType=VARCHAR},
            </if>
            <if test="toWarehouseId != null">
                to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR},
            </if>
            <if test="toWarehouseName != null">
                to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR},
            </if>
            <if test="srcWarehouseId != null">
                src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR},
            </if>
            <if test="srcWarehouseName != null">
                src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR},
            </if>
            <if test="purchasePrice != null">
                purchase_price = #{purchasePrice,jdbcType=BIGINT},
            </if>
            <if test="stockPickingPrice != null">
                stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT},
            </if>
            <if test="stockPickingStatus != null">
                stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT},
            </if>
            <if test="purchaseAmount != null">
                purchase_amount = #{purchaseAmount,jdbcType=BIGINT},
            </if>
            <if test="pickingAmount != null">
                picking_amount = #{pickingAmount,jdbcType=BIGINT},
            </if>
            <if test="operatorId != null">
                operator_id = #{operatorId,jdbcType=VARCHAR},
            </if>
            <if test="operatorName != null">
                operator_name = #{operatorName,jdbcType=VARCHAR},
            </if>
            <if test="odooPickingIncomeId != null">
                odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER},
            </if>
            <if test="odooPickingOutId != null">
                odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER},
            </if>
            <if test="stockPickingType != null">
                stock_picking_type = #{stockPickingType,jdbcType=TINYINT},
            </if>
            <if test="stock != null">
                stock = #{stock,jdbcType=BIGINT},
            </if>
            <if test="incomeReason != null">
                income_reason = #{incomeReason,jdbcType=TINYINT},
            </if>
            <if test="outReason != null">
                out_reason = #{outReason,jdbcType=TINYINT},
            </if>
            <if test="remark != null">
                remark = #{remark,jdbcType=VARCHAR},
            </if>
            <if test="validStatus!=null">
                valid_status = #{validStatus,jdbcType=TINYINT},
            </if>
            <if test="stockPickingDocumentId != null">
                stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR},
            </if>
            <if test="srcOrderDocumentId != null">
                src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR},
            </if>
            <if test="toStoreId != null">
                to_store_id = #{toStoreId,jdbcType=VARCHAR},
            </if>
            <if test="toStoreName != null">
                to_store_name = #{toStoreName,jdbcType=VARCHAR},
            </if>
            <if test="auditorId != null">
                auditor_id = #{auditorId,jdbcType=VARCHAR},
            </if>
            <if test="auditorName != null">
                auditor_name = #{auditorName,jdbcType=VARCHAR},
            </if>
            <if test="auditorTime != null">
                audit_time = #{auditorTime,jdbcType=TIMESTAMP},
            </if>
            <if test="businessManId != null">
                business_man_id = #{businessManId,jdbcType=VARCHAR},
            </if>
            <if test="businessManName != null">
                business_man_name = #{businessManName,jdbcType=VARCHAR},
            </if>
            <if test="purchaseReturnReason != null">
                purchase_return_reason = #{purchaseReturnReason, jdbcType=TINYINT},
            </if>
            <if test="distinctPrice != null">
                distinct_price = #{distinctPrice, jdbcType=BIGINT},
            </if>
            <if test="purchaseReturnTime != null">
                purchase_return_time = #{purchaseReturnTime, jdbcType=TIMESTAMP},
            </if>
            <if test="purchaseType != null">
                purchase_type = #{purchaseType, jdbcType=TINYINT},
            </if>
            <if test="auditorTime == null and delectAction == 2">
                audit_time = NOW(),
            </if>
            <if test="purchaseReturnStatus != null">
                purchase_return_status = #{purchaseReturnStatus, jdbcType=TINYINT},
            </if>
            <if test="finishPurchaseReturnAmount != null">
                finish_purchase_return_amount = #{finishPurchaseReturnAmount, jdbcType=BIGINT},
            </if>
            update_time = NOW()
        </set>
        WHERE stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
    </update>
    <select id="selectByType" resultMap="BaseResultMap"
            parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="validStatus!=null">
                AND valid_status = #{validStatus,jdbcType=TINYINT}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreId != null">
                AND to_store_id = #{toStoreId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreName != null">
                AND to_store_name = #{toStoreName,jdbcType=VARCHAR}
            </if>
        </where>
        <if test="pageSize != null and pageSize > 0">
            LIMIT #{recordNo,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
        </if>
    </select>
    <select id="queryBystockPickingId" resultMap="BaseResultMap"
            parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name = #{supplierName,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseId != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="purchasePrice != null">
                AND purchase_price = #{purchasePrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingPrice != null">
                AND stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="purchaseAmount != null">
                AND purchase_amount = #{purchaseAmount,jdbcType=BIGINT}
            </if>
            <if test="pickingAmount != null">
                AND picking_amount = #{pickingAmount,jdbcType=BIGINT}
            </if>
            <if test="operatorId != null">
                AND operator_id = #{operatorId,jdbcType=VARCHAR}
            </if>
            <if test="operatorName != null">
                AND operator_name = #{operatorName,jdbcType=VARCHAR}
            </if>
            <if test="odooPickingIncomeId != null">
                AND odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER}
            </if>
            <if test="odooPickingOutId != null">
                AND odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stock != null">
                AND stock = #{stock,jdbcType=BIGINT}
            </if>
            <if test="incomeReason != null">
                AND income_reason = #{incomeReason,jdbcType=TINYINT}
            </if>
            <if test="outReason != null">
                AND out_reason = #{outReason,jdbcType=TINYINT}
            </if>
            <if test="remark != null">
                AND remark = #{remark,jdbcType=VARCHAR}
            </if>
            <if test="createTime != null">
                AND create_time = #{createTime,jdbcType=TIMESTAMP}
            </if>
            <if test="updateTime != null">
                AND update_time = #{updateTime,jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id = #{stockPickingDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreId != null">
                AND to_store_id = #{toStoreId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreName != null">
                AND to_store_name = #{toStoreName,jdbcType=VARCHAR}
            </if>
        </where>
    </select>

    <select id="querySupplierStockPicking" resultMap="BaseResultMap"
            parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
            valid_status = 0
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name = #{supplierName,jdbcType=VARCHAR}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <!--            	查询时间段数据 -->
            <if test="oneTime != null and oneTime !=''">
                AND create_time <![CDATA[>=]]> #{oneTime, jdbcType=TIMESTAMP}
            </if>
            <if test="twoTime != null and twoTime !=''">
                AND create_time <![CDATA[<=]]> #{twoTime, jdbcType=TIMESTAMP}
            </if>
            <!--            	查询list中供应商的退货数据 -->
            <if test="supplierIdlist != null">
                AND supplier_id in (
                <foreach collection="supplierIdlist" item="supplierId" separator=",">
                    #{supplierId, jdbcType=VARCHAR}
                </foreach>
                )
            </if>
        </where>
    </select>
    <select id="selectStockInAndOut" resultMap="BaseResultMap"
            parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
        	valid_status =0
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id LIKE concat('%', #{stockPickingDocumentId,jdbcType=VARCHAR}, '%')
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreId != null">
                AND to_store_id = #{toStoreId,jdbcType=VARCHAR}
            </if>
            <if test="toStoreName != null">
                AND to_store_name = #{toStoreName,jdbcType=VARCHAR}
            </if>
            <if test="beginTime != null and beginTime != ''">
                AND create_time <![CDATA[>=]]> #{beginTime, jdbcType=TIMESTAMP}
            </if>
            <if test="endTime != null and endTime !=''">
                AND create_time <![CDATA[<=]]> #{endTime, jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stockPickingType == null">
                AND (stock_picking_type = 2 OR stock_picking_type = 3)
            </if>
            <if test="toWarehouseId != null and stockPickingType != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="auditorId != null">
                AND auditor_id = #{auditorId,jdbcType=VARCHAR}
            </if>
            <if test="auditorName != null">
                AND auditor_name = #{auditorName,jdbcType=VARCHAR}
            </if>
            <if test="auditorTime != null">
                AND audit_time = #{auditorTime,jdbcType=TIMESTAMP}
            </if>
            <if test="businessManId != null">
                AND business_man_id = #{businessManId,jdbcType=VARCHAR}
            </if>
            <if test="businessManName != null">
                AND business_man_name = #{businessManName,jdbcType=VARCHAR}
            </if>
            <if test="stockPickingType == null and toWarehouseId !=null"  >
                AND (to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR} OR
                src_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
                )
            </if>
        </where>
        ORDER BY update_time DESC
        <if test="pageSize != null and pageSize > 0">
            LIMIT #{recordNo,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
        </if>
    </select>
    <select id="countAllStockInAndOut" parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingRequest"
            resultType="java.lang.Integer">
        SELECT
        COUNT(*)
        FROM stock_picking
        <where>
            valid_status = 0
            <if test="stockPickingId != null">
                AND stock_picking_id = #{stockPickingId,jdbcType=VARCHAR}
            </if>
            <if test="brandId != null">
                AND brand_id = #{brandId,jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId,jdbcType=VARCHAR}
            </if>
            <if test="srcOrderId != null">
                AND src_order_id = #{srcOrderId,jdbcType=VARCHAR}
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId,jdbcType=VARCHAR}
            </if>
            <if test="supplierName != null">
                AND supplier_name = #{supplierName,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseId != null and stockPickingType != null">
                AND to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="toWarehouseName != null">
                AND to_warehouse_name = #{toWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseId != null">
                AND src_warehouse_id = #{srcWarehouseId,jdbcType=VARCHAR}
            </if>
            <if test="srcWarehouseName != null">
                AND src_warehouse_name = #{srcWarehouseName,jdbcType=VARCHAR}
            </if>
            <if test="purchasePrice != null">
                AND purchase_price = #{purchasePrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingPrice != null">
                AND stock_picking_price = #{stockPickingPrice,jdbcType=BIGINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="purchaseAmount != null">
                AND purchase_amount = #{purchaseAmount,jdbcType=BIGINT}
            </if>
            <if test="pickingAmount != null">
                AND picking_amount = #{pickingAmount,jdbcType=BIGINT}
            </if>
            <if test="operatorId != null">
                AND operator_id = #{operatorId,jdbcType=VARCHAR}
            </if>
            <if test="operatorName != null">
                AND operator_name = #{operatorName,jdbcType=VARCHAR}
            </if>
            <if test="odooPickingIncomeId != null">
                AND odoo_picking_income_id = #{odooPickingIncomeId,jdbcType=INTEGER}
            </if>
            <if test="odooPickingOutId != null">
                AND odoo_picking_out_id = #{odooPickingOutId,jdbcType=INTEGER}
            </if>
            <if test="stock != null">
                AND stock = #{stock,jdbcType=BIGINT}
            </if>
            <if test="incomeReason != null">
                AND income_reason = #{incomeReason,jdbcType=TINYINT}
            </if>
            <if test="outReason != null">
                AND out_reason = #{outReason,jdbcType=TINYINT}
            </if>
            <if test="remark != null">
                AND remark = #{remark,jdbcType=VARCHAR}
            </if>
            <if test="createTime != null">
                AND create_time = #{createTime,jdbcType=TIMESTAMP}
            </if>
            <if test="updateTime != null">
                AND update_time = #{updateTime,jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingDocumentId != null">
                AND stock_picking_document_id LIKE concat('%', #{stockPickingDocumentId,jdbcType=VARCHAR}, '%')
            </if>
            <if test="srcOrderDocumentId != null">
                AND src_order_document_id = #{srcOrderDocumentId,jdbcType=VARCHAR}
            </if>
            <if test="beginTime != null and beginTime != ''">
                AND create_time <![CDATA[>=]]> #{beginTime, jdbcType=TIMESTAMP}
            </if>
            <if test="endTime != null and endTime !=''">
                AND create_time <![CDATA[<=]]> #{endTime, jdbcType=TIMESTAMP}
            </if>
            <if test="stockPickingType == null">
                AND (stock_picking_type = 2 OR stock_picking_type = 3)
            </if>
            <if test="stockPickingType != null">
                AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            </if>
            <if test="stockPickingStatus != null">
                AND stock_picking_status = #{stockPickingStatus,jdbcType=TINYINT}
            </if>
            <if test="auditorId != null">
                AND auditor_id = #{auditorId,jdbcType=VARCHAR}
            </if>
            <if test="auditorName != null">
                AND auditor_name = #{auditorName,jdbcType=VARCHAR}
            </if>
            <if test="auditorTime != null">
                AND audit_time = #{auditorTime,jdbcType=TIMESTAMP}
            </if>
            <if test="businessManId != null">
                AND business_man_id = #{businessManId,jdbcType=VARCHAR}
            </if>
            <if test="businessManName != null">
                AND business_man_name = #{businessManName,jdbcType=VARCHAR}
            </if>
            <if test="stockPickingType == null and toWarehouseId !=null"  >
                AND (to_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR} OR
                src_warehouse_id = #{toWarehouseId,jdbcType=VARCHAR}
                )
            </if>
        </where>
    </select>
    <select id="queryPurchaseOrder" parameterType="com.hanyun.scm.api.domain.request.payment.PurchaseQueryRequest" resultType="com.hanyun.scm.api.domain.dto.PurchasePaymentDTO">
        SELECT
        brand_id brandId, store_id storeId, stock_picking_id orderId, stock_picking_document_id orderDocumentId, stock_picking_type type,
        update_time orderTime, (stock_picking_price - distinct_price) orderPrice, payment_price paymentPrice, distinct_price distinctPrice
        FROM stock_picking
        <where>
            <if test="brandId != null">
                AND brand_id = #{brandId, jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId, jdbcType=VARCHAR}
            </if>
            <if test="orderId != null">
                AND stock_picking_document_id LIKE concat(#{orderId, jdbcType=VARCHAR}, '%')
            </if>
            <if test="queryBeginTime != null">
                AND create_time <![CDATA[>=]]> #{queryBeginTime, jdbcType=TIMESTAMP}
            </if>
            <if test="queryEndTime != null">
                AND create_time <![CDATA[<=]]> #{queryEndTime, jdbcType=TIMESTAMP}
            </if>
            <if test="paymentType == 1">
                AND stock_picking_type = 0
            </if>
            <if test="paymentType == 2">
                AND stock_picking_type = 1
            </if>
            <if test="paymentType != 1 and paymentType != 2">
                AND (stock_picking_type = 0
                OR stock_picking_type = 1)
            </if>
            and payment_price <![CDATA[<]]> stock_picking_price
        </where>
        ORDER BY update_time DESC
        <if test="pageSize != null and pageSize > 0">
            LIMIT #{recordNo,jdbcType=INTEGER}, #{pageSize,jdbcType=INTEGER}
        </if>
    </select>
    <select id="countPurchaseOrder" parameterType="com.hanyun.scm.api.domain.request.payment.PurchaseQueryRequest" resultType="java.lang.Integer">
        SELECT
        COUNT(1)
        FROM stock_picking
        <where>
            <if test="brandId != null">
                AND brand_id = #{brandId, jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId, jdbcType=VARCHAR}
            </if>
            <if test="orderId != null">
                AND stock_picking_document_id LIKE concat(#{orderId, jdbcType=VARCHAR}, '%')
            </if>
            <if test="queryBeginTime != null">
                AND create_time <![CDATA[>=]]> #{queryBeginTime, jdbcType=TIMESTAMP}
            </if>
            <if test="queryEndTime != null">
                AND create_time <![CDATA[<=]]> #{queryEndTime, jdbcType=TIMESTAMP}
            </if>
            <if test="paymentType == 1">
                AND stock_picking_type = 0
            </if>
            <if test="paymentType == 2">
                AND stock_picking_type = 1
            </if>
            <if test="paymentType != 1 and paymentType != 2">
                AND (stock_picking_type = 0
                OR stock_picking_type = 1)
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId, jdbcType=VARCHAR}
            </if>
            and payment_price <![CDATA[<]]> stock_picking_price
        </where>
    </select>
    <select id="sumPurchaseOrder" parameterType="com.hanyun.scm.api.domain.request.payment.PurchaseQueryRequest" resultType="com.hanyun.scm.api.domain.dto.PurchasePaymentDTO">
        SELECT SUM(stock_picking_price - distinct_price) orderPrice,
          SUM(payment_price) paymentPrice,
          SUM(distinct_price) distinctPrice
        FROM stock_picking
        <where>
            <if test="brandId != null">
                AND brand_id = #{brandId, jdbcType=VARCHAR}
            </if>
            <if test="storeId != null">
                AND store_id = #{storeId, jdbcType=VARCHAR}
            </if>
            <if test="orderId != null">
                AND stock_picking_document_id LIKE concat(#{orderId, jdbcType=VARCHAR}, '%')
            </if>
            <if test="queryBeginTime != null">
                AND create_time <![CDATA[<]]> #{queryBeginTime, jdbcType=TIMESTAMP}
            </if>
            <if test="paymentType == 1">
                AND stock_picking_type = 0
            </if>
            <if test="paymentType == 2">
                AND stock_picking_type = 1
            </if>
            <if test="paymentType != 1 and paymentType != 2">
                AND (stock_picking_type = 0
                OR stock_picking_type = 1)
            </if>
            <if test="supplierId != null">
                AND supplier_id = #{supplierId, jdbcType=VARCHAR}
            </if>
            and payment_price <![CDATA[<]]> stock_picking_price
        </where>
    </select>
    <update id="payment" parameterType="com.hanyun.scm.api.domain.request.payment.PurchasePaymentRequest">
        UPDATE stock_picking
        <set>
            <if test="paymentPrice != null">
                payment_price = payment_price + #{paymentPrice, jdbcType=INTEGER},
            </if>
            <if test="paymentStatus != null">
                payment_status = #{paymentStatus, jdbcType=TINYINT},
            </if>
            update_time = NOW()
        </set>
        WHERE stock_picking_id = #{orderId,jdbcType=VARCHAR}
    </update>
    <select id="selectForAuditOrder" parameterType="com.hanyun.scm.api.domain.request.stock.StockPickingQueryForAuditOrderRequest">
        SELECT
        <include refid="Base_Column_List"/>
        FROM stock_picking
        <where>
            <if test="ids != null">
                AND stock_picking_id IN (NULL
                <foreach collection="ids" item="id">
                    , #{id, jdbcType=VARCHAR}
                </foreach>
                )
            </if>
        </where>
        ORDER BY id DESC
    </select>

    <select id="queryIds" resultType="java.lang.String" parameterType="com.hanyun.scm.api.domain.BaseParams">
        SELECT stock_picking_id
        FROM stock_picking
        <where>
            (stock_picking_status = 3 OR stock_picking_status = 4)
            AND stock_picking_type = #{stockPickingType,jdbcType=TINYINT}
            AND update_time <![CDATA[>=]]> #{beginTime,jdbcType=TIMESTAMP}
            AND update_time <![CDATA[<=]]> #{endTime,jdbcType=TIMESTAMP}
            AND valid_status = 0
        </where>
    </select>

</mapper>